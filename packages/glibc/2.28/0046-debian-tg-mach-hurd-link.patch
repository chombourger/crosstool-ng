From: Samuel Thibault <samuel.thibault@ens-lyon.org>
Subject: [PATCH] Add -lmachuser -lhurduser to libc.so on GNU/Hurd.

http://lists.gnu.org/archive/html/bug-hurd/2011-03/msg00112.html

2011-03-29  Samuel Thibault  <samuel.thibault@ens-lyon.org>

        * Makerules ($(inst_libdir)/libc.so): Add -lmachuser -lhurduser to
        libc.so on GNU/Hurd.

It's still unclear what we want to aim for.

---
 Makerules | 3 +++
 1 file changed, 3 insertions(+)

Index: glibc-2.28/Makerules
===================================================================
--- glibc-2.28.orig/Makerules
+++ glibc-2.28/Makerules
@@ -1174,6 +1174,9 @@ $(inst_libdir)/libc.so: $(common-objpfx)
 	      '$(libdir)/$(patsubst %,$(libtype.oS),$(libprefix)$(libc-name))'\
 	      ' AS_NEEDED (' $(rtlddir)/$(rtld-installed-name) ') )' \
 	) > $@.new
+ifeq ($(patsubst gnu%,,$(config-os)),)
+	echo 'INPUT ( AS_NEEDED ( -lmachuser -lhurduser ) )' >> $@.new
+endif
 	mv -f $@.new $@
 
 endif
